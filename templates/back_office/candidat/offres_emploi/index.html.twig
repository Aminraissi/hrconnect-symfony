{% extends 'back_office.html.twig' %}

{% block title %}
	Liste des offres d'emploi
{% endblock %}

{% block css %}
	{{ parent() }}
	<style>
		.btn-success {
			background-color: #28a745;
			color: white;
			border-radius: 5px;
			padding: 5px 10px;
			margin-right: 5px;
			display: inline-block;
		}
		.btn-success:hover {
			background-color: #218838;
		}
		.btn-info {
			background-color: #17a2b8;
			color: white;
			border-radius: 5px;
			padding: 5px 10px;
			margin-right: 5px;
			display: inline-block;
		}
		.btn-info:hover {
			background-color: #138496;
		}
		.btn-view,
		.btn-apply {
			display: inline-block;
			padding: 5px 10px;
			margin-right: 5px;
			border-radius: 5px;
			color: white;
		}
		.btn-view {
			background-color: #17a2b8;
		}
		.btn-apply {
			background-color: #28a745;
		}
		.action {
			display: flex;
			align-items: center;
			justify-content: center;
		}
		/* Styles de base pour le tableau */
		.table-heading {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 15px 20px;
		}
		.table-heading h2 {
			margin: 0;
		}
	</style>
{% endblock %}

{% block body %}
	<div class="row">
		<div class="col-xl-12 col-sm-12 col-12">
			<div class="breadcrumb-path mb-4">
				<ul class="breadcrumb">
					<li class="breadcrumb-item">
						<a href="{{ path('app_back_office') }}"><img src="{{ asset('assets/img/dash.png')}}" class="mr-2" alt="breadcrumb"/>Home</a>
					</li>
					<li class="breadcrumb-item active">
						Liste des offres d'emploi</li>
				</ul>
				<h3>Offres d'emploi</h3>
			</div>
		</div>

		<!-- Le formulaire de recherche a été supprimé et remplacé par une page dédiée accessible via le menu -->
		<div class="col-xl-12 col-sm-12 col-12 mb-4">
			<div class="head-link-set">
				<ul>
					<li><a class="active"href="{{ path('back.candidat.offres_emploi.index') }}">Toutes les offres</a></li>
					<li><ahref="{{ path('back.candidat.offres_emploi.search') }}">Rechercher Offre</a></li>
					<li><ahref="{{ path('app_candidature_suivi') }}">Suivre ma candidature</a></li>
				</ul>
				{# Pas de bouton "Ajouter une offre" pour les candidats #}
			</div>
		</div>
		<div class="col-xl-12 col-sm-12 col-12 mb-4">
			<div class="row">
				<div class="col-xl-10 col-sm-8 col-12 ">
					<label class="employee_count">{{ offres|length }}
						Offres</label>
				</div>
			</div>
		</div>
		<div class="col-xl-12 col-sm-12 col-12 mb-4">
			<div class="card">
				<div class="table-heading">
					<h2>Liste des offres</h2>
				</div>
				<!-- Message d'alerte supprimé car la recherche est maintenant sur une page dédiée -->
				<!-- Le loader de recherche a été supprimé -->
				<div class="table-responsive search-results" id="search-results">
					<table class="table custom-table no-footer">
						<thead>
							<tr>
								<th>Titre</th>
								<th>Localisation</th>
								<th>Actions</th>
							</tr>
						</thead>
						<tbody id="results-body">
							{% for offre in offres %}
								<tr>
									<td>{{ offre.title }}</td>
									<td>{{ offre.location }}</td>
									<td>
										<a href="{{ path('back.candidat.offres_emploi.show', {'id': offre.id}) }}" class="btn btn-info btn-sm">
											Voir détail
										</a>
										<a href="{{ path('app_candidat_candidature_new', {'id': offre.id}) }}" class="btn btn-success btn-sm">
											Postuler
										</a>
									</td>
								</tr>
							{% else %}
								<tr>
									<td colspan="3" class="text-center">Aucune offre disponible</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block javascripts %}
	{# Charger uniquement les scripts nécessaires, sans ApexCharts #}
	<script src="{{ asset('assets/js/jquery-3.6.0.min.js') }}"></script>
	<script src="{{ asset('assets/js/popper.min.js') }}"></script>
	<script src="{{ asset('assets/js/bootstrap.min.js') }}"></script>
	<script src="{{ asset('assets/js/feather.min.js') }}"></script>
	<script src="{{ asset('assets/plugins/slimscroll/jquery.slimscroll.min.js') }}"></script>
	<script src="{{ asset('assets/js/script.js') }}"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>

	{# Remplacer le script chart-data.js par notre version sécurisée #}
	<script>
		// Remplacer le script chart-data.js par notre version sécurisée
document.addEventListener('DOMContentLoaded', function () { // Trouver le script chart-data.js
var scripts = document.getElementsByTagName('script');
for (var i = 0; i < scripts.length; i++) {
if (scripts[i].src.indexOf('chart-data.js') !== -1) { // Remplacer le script par notre version sécurisée
scripts[i].src = '{{ asset("assets/assets/plugins/apexchart/chart-data-safe.js") }}';
console.log('Script chart-data.js remplacé par chart-data-safe.js');
break;
}
}
});
	</script>

	<script>
		// Initialiser les icônes Feather au chargement de la page
document.addEventListener('DOMContentLoaded', function () {
if (typeof feather !== 'undefined') {
feather.replace();
}
});
	</script>
{% endblock %}
